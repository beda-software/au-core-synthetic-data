
# AU Core Synthetic Data

Data generated by Synthea then mapped to be valid according to AU Core IG

## Pipeline

1. **Generate Data**: Use dockerized Synthea and a custom module to generate data in CSV format.
    * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/synthea/compose.yml#L8
    * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/synthea/modules/encounter-observation-observation-condition-medication-encounter-end.json#L2
2. **Map/Post-Process CSV Files**:
    * Map target patients to the generated patients (because it is not possible to assign specific patient IDs in Synthea data).
      * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/mapping_script/config.yaml#L1
    * Rename column names in the generated CSV files according to the mapping configuration.
      * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/mapping_script/config.yaml#L5
    * Rename the resulting CSV files based on the mapping configuration.
      * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/mapping_script/config.yaml#L162
    * Generate UUID for CSV if ID is not exist
      * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/mapping_script/config.yaml#L172
    * Delete unused CSV files.
      * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/mapping_script/config.yaml#L180
    * Add additional columns to the generated CSV files to maintain a structure for the Csv2Fhir.
      * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/mapping_script/config.yaml#L192
    * Perform post-processing using the configuration to enrich the data, as Synthea has a limited number of fields.
      * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/mapping_script/config.yaml#L720
3. **Generate FHIR Resources**: Use the Csv2Fhir application to convert CSV data into FHIR resources in JSON format.
    * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/Makefile#L25
4. **Validate Results**: Validate the generated FHIR resources using the official FHIR Validator CLI.
   * https://github.com/beda-software/au-core-synthetic-data/blob/c7e43f8d73110b842dace007b7b36e97074b3777/Makefile#L3
5. **Create an Archive**: Bundle the generated FHIR resources in both JSON and CSV formats into an archive.

## Run

```bash
./download-mapper.sh
```

``` bash
make pipeline
```

